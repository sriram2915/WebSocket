<!DOCTYPE html>
<html>
<body>

<h3>Private Chat</h3>

<label>Your Username:</label>
<input type="text" id="username" placeholder="Your name" />
<br>

<label>Recipient Username:</label>
<input type="text" id="recipient" placeholder="Recipient name" />
<br>

<button onclick="connect()">Connect</button>
<br><br>

<input id="msg" placeholder="Type your message..." />
<button onclick="sendMessage()">Send</button>

<div id="chat"></div>

<script>
    let socket;
    let myName;
    let recipient;

    function connect() {
        myName = document.getElementById("username").value.trim();
        recipient = document.getElementById("recipient").value.trim();

        if (!myName || !recipient) {
            alert("Enter both usernames!");
            return;
        }

        // Connect to WebSocket server with sender username
        socket = new WebSocket("ws://localhost:8090/chat/" + myName);

        socket.onopen = () => {
            log("Connected as " + myName + " (sending to " + recipient + ")");
        };

        socket.onmessage = (event) => {
            log(event.data);
        };
    }

    function sendMessage() {
        if (!socket || socket.readyState !== WebSocket.OPEN) {
            alert("Connect first!");
            return;
        }

        let msgInput = document.getElementById("msg");
        let text = msgInput.value.trim();
        if (!text) return;

        socket.send(recipient + ":" + text);
        log("You to " + recipient + ": " + text);
        msgInput.value = "";
    }

    function log(msg) {
        document.getElementById("chat").innerHTML += msg + "<br>";
    }
</script>

</body>
</html>
